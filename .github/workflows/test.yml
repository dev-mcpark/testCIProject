name: test work flow

on: 
  push:
    branches:
      - feature/*
      - develope/*
      - hotfix/*
      - release/*

jobs:
  create_commit:
    runs-on: ubuntu-latest
    steps:
    - name: Create issue using REST API
      run: |
        curl --request POST \
        --url https://api.github.com/repos/${{ github.repository }}/issues \
        --header 'authorization: Bearer ${{ secrets.GITHUB_TOKEN }}' \
        --header 'content-type: application/json' \
        --data '{
          "title": "Automated issue for commit: ${{ github.sha }}", 
          "body": "This issue was automatically created by the GitHub Action workflow **${{ github.workflow }}**. \n\n The commit hash was: _${{ github.sha }}_." 
          }'

  build:

    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v1
    - name: Run a one-line script
      run: echo test work flow!
    - name: Run a multi-line script
      run: |
        echo Add other actions to build,
        echo test, and deploy your project.
  
  test:
    name: code test
    needs: build
    runs-on: ubuntu-latest
    steps:
    - name: print test
      env:
        DJANGO_SETTINGS_MODULE: timespread.settings_local_test
      run: | 
        echo $DJANGO_SETTINGS_MODULE

  deploy:
    name: deploy
    needs: test
    runs-on: ubuntu-latest

    steps:
      - name: My conditional step
        if: github.event_name == 'pull_request' && github.event.action == 'unassigned'
        run: echo This event is a pull request that had an assignee removed.


    
